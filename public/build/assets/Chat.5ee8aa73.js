import{J as k,d as V,u as R,r,o as j,b as T,c as f,f as U,i as s,g as l,w as n,n as i,Q as A,_ as F,e as E,l as L,E as m,j as w,k as S,ai as B,aF as M}from"./app.947dfe37.js";import{Q as $}from"./QInput.0a5b359e.js";import{Q as q}from"./QTd.5e156fed.js";import{Q as D}from"./QTable.8d314c3a.js";const N={class:"row q-pa-md justify-around max-h-screen"},O={class:"col-8"},P={class:"row full-width justify-between"},I=s("div",{class:"col-6"},[s("span",{class:"text-h6"},"Messages")],-1),W={class:"col-3 flex justify-end"},z={class:"row justify-end q-gutter-sm items-baseline"},H={class:"col-auto"},J={class:"col-auto"},G={class:"col-3"},te={__name:"Chat",setup(K){k(e=>({"070c4fde":Q.value}));const h=V(()=>F(()=>import("./chatWindow.b36be9ca.js"),["assets/chatWindow.b36be9ca.js","assets/app.947dfe37.js","assets/app.51e76855.css","assets/QInput.0a5b359e.js","assets/chatWindow.0944a5e7.css"]));let o=R(),g=r({sortBy:"updatedAt",descending:!0,page:1,rowsPerPage:0});j(async()=>{await window.Echo.private("rooms").listen("RoomsUpdate",e=>{e.flag.flag==1&&o.updateRoom(e.flag.message),e.flag.flag==2&&o.updateWebWayMessage(e.flag.message,e.flag.room_id),e.flag.flag==3,e.flag.flag==4}),await o.getSupportRooms(),await o.getFullUserList()}),T(async()=>{await window.Echo.leave("rooms")});let u=r(""),c=r(),d=r(),b=f(()=>o.userList),p=f(()=>c.value?b.value.filter(e=>e.text.toLowerCase().indexOf(c.value)>-1):o.userList),y=(e,t,a)=>{t(()=>{c.value=e.toLowerCase(),p.value.length>0&&e&&(d.value=p.value[0])})},_=async()=>{await axios({method:"post",withCredentials:!0,url:"/api/support/makeroom/"+d.value.value,headers:{Accept:"application/json","Content-Type":"application/json"}})},x=async e=>{await axios({method:"delete",withCredentials:!0,url:"/api/support/delete/"+e,headers:{Accept:"application/json","Content-Type":"application/json"}}),o.supportRooms=o.supportRooms.filter(t=>t.id!=e)},C=r([{name:"name",label:"Name",align:"left",field:e=>e.user.name,format:e=>`${e}`,sortable:!0},{name:"updatedAt",label:"Last Updated",align:"left",field:e=>e.updated_at,format:e=>`${e}`,sortable:!0},{name:"actions",label:"Actions",align:"right"}]),Q=f(()=>{let e=100;return o.size.height-e+"px"});return(e,t)=>(E(),U("div",N,[s("div",O,[l(D,{title:"Messages",class:"myMessageTable myRound",rows:i(o).supportRooms,columns:C.value,"table-class":" text-webway","table-header-class":" text-weight-bolder","row-key":"id",dense:"",ref:"tableRef",dark:"",filter:u.value,rounded:"",color:"amber","hide-bottom":"",pagination:g.value,"onUpdate:pagination":t[1]||(t[1]=a=>g.value=a)},{top:n(a=>[s("div",P,[I,s("div",W,[l($,{borderless:"",dense:"",debounce:"300",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=v=>u.value=v),placeholder:"Search"},{append:n(()=>[l(L,{"q-icon":"",name:"fa-solid fa-magnifying-glass"})]),_:1},8,["modelValue"]),l(m,{flat:"",round:"",dense:"",icon:a.inFullscreen?"fullscreen_exit":"fullscreen",onClick:a.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])])])]),"body-cell-actions":n(a=>[l(q,{props:a},{default:n(()=>[s("div",z,[s("div",H,[l(i(h),{item:a.row},null,8,["item"])]),s("div",J,[l(m,{"text-color":"negative",round:"",flat:"",padding:"none",icon:"fa-solid fa-trash-can",onClick:v=>i(x)(a.row.id)},null,8,["onClick"])])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","pagination"])]),s("div",G,[l(A,{class:"my-card myRound"},{default:n(()=>[l(w,{class:"bg-primary myCardHeader text-center text-h6"},{default:n(()=>[S(" Users ")]),_:1}),l(w,null,{default:n(()=>[l(B,{modelValue:d.value,"onUpdate:modelValue":[t[2]||(t[2]=a=>d.value=a),t[3]||(t[3]=a=>i(_)())],"option-value":"value","option-label":"text",onFilter:i(y),"input-debounce":"0","map-options":"","use-input":"","hide-selected":"",options:p.value,label:"Standard",filled:"","fill-input":""},null,8,["modelValue","onFilter","options"])]),_:1}),l(M,{align:"center"},{default:n(()=>[l(m,{flat:"",label:"add",onClick:t[4]||(t[4]=a=>i(_)())})]),_:1})]),_:1})])]))}};export{te as default};
