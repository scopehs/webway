import{A as F,a5 as P,B as U,a6 as z,aM as Y,r as y,c as f,bl as K,C as Q,G as O,l as G,S as J,H as W,aI as X,aN as R,K as Z,d as p,_ as ee,u as te,o as ae,b as ne,e as D,f as le,g as c,n as _,E as N,w as d,Q as oe,j as V,k as ie,q as re,s as ce,i as j,aH as ue}from"./app.947dfe37.js";import{Q as se}from"./QTd.5e156fed.js";import{Q as de}from"./QTable.8d314c3a.js";import{Q as me}from"./QInput.0a5b359e.js";import{d as fe}from"./date.e8c4c223.js";const ve=F({name:"QRating",props:{...P,...U,modelValue:{type:Number,required:!0},max:{type:[String,Number],default:5},icon:[String,Array],iconHalf:[String,Array],iconSelected:[String,Array],iconAriaLabel:[String,Array],color:[String,Array],colorHalf:[String,Array],colorSelected:[String,Array],noReset:Boolean,noDimming:Boolean,readonly:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{slots:x,emit:v}){const{proxy:{$q:C}}=J(),I=z(e),h=Y(e),L=W(h),i=y(0);let r={};const u=f(()=>e.readonly!==!0&&e.disable!==!0),$=f(()=>`q-rating row inline items-center q-rating--${u.value===!0?"":"non-"}editable`+(e.noDimming===!0?" q-rating--no-dimming":"")+(e.disable===!0?" disabled":"")+(e.color!==void 0&&Array.isArray(e.color)===!1?` text-${e.color}`:"")),k=f(()=>{const t=Array.isArray(e.icon)===!0?e.icon.length:0,a=Array.isArray(e.iconSelected)===!0?e.iconSelected.length:0,s=Array.isArray(e.iconHalf)===!0?e.iconHalf.length:0,g=Array.isArray(e.color)===!0?e.color.length:0,b=Array.isArray(e.colorSelected)===!0?e.colorSelected.length:0,n=Array.isArray(e.colorHalf)===!0?e.colorHalf.length:0;return{iconLen:t,icon:t>0?e.icon[t-1]:e.icon,selIconLen:a,selIcon:a>0?e.iconSelected[a-1]:e.iconSelected,halfIconLen:s,halfIcon:s>0?e.iconHalf[a-1]:e.iconHalf,colorLen:g,color:g>0?e.color[g-1]:e.color,selColorLen:b,selColor:b>0?e.colorSelected[b-1]:e.colorSelected,halfColorLen:n,halfColor:n>0?e.colorHalf[n-1]:e.colorHalf}}),H=f(()=>{if(typeof e.iconAriaLabel=="string"){const t=e.iconAriaLabel.length>0?`${e.iconAriaLabel} `:"";return a=>`${t}${a}`}if(Array.isArray(e.iconAriaLabel)===!0){const t=e.iconAriaLabel.length;if(t>0)return a=>e.iconAriaLabel[Math.min(a,t)-1]}return(t,a)=>`${a} ${t}`}),q=f(()=>{const t=[],a=k.value,s=Math.ceil(e.modelValue),g=u.value===!0?0:null,b=e.iconHalf===void 0||s===e.modelValue?-1:s;for(let n=1;n<=e.max;n++){const m=i.value===0&&e.modelValue>=n||i.value>0&&i.value>=n,A=b===n&&i.value<n,M=i.value>0&&(A===!0?s:e.modelValue)>=n&&i.value<n,T=A===!0?n<=a.halfColorLen?e.colorHalf[n-1]:a.halfColor:a.selColor!==void 0&&m===!0?n<=a.selColorLen?e.colorSelected[n-1]:a.selColor:n<=a.colorLen?e.color[n-1]:a.color,E=(A===!0?n<=a.halfIconLen?e.iconHalf[n-1]:a.halfIcon:a.selIcon!==void 0&&(m===!0||M===!0)?n<=a.selIconLen?e.iconSelected[n-1]:a.selIcon:n<=a.iconLen?e.icon[n-1]:a.icon)||C.iconSet.rating.icon;t.push({name:(A===!0?n<=a.halfIconLen?e.iconHalf[n-1]:a.halfIcon:a.selIcon!==void 0&&(m===!0||M===!0)?n<=a.selIconLen?e.iconSelected[n-1]:a.selIcon:n<=a.iconLen?e.icon[n-1]:a.icon)||C.iconSet.rating.icon,attrs:{tabindex:g,role:"radio","aria-checked":e.modelValue===n?"true":"false","aria-label":H.value(n,E)},iconClass:"q-rating__icon"+(m===!0||A===!0?" q-rating__icon--active":"")+(M===!0?" q-rating__icon--exselected":"")+(i.value===n?" q-rating__icon--hovered":"")+(T!==void 0?` text-${T}`:"")})}return t}),B=f(()=>{const t={role:"radiogroup"};return e.disable===!0&&(t["aria-disabled"]="true"),e.readonly===!0&&(t["aria-readonly"]="true"),t});function S(t){if(u.value===!0){const a=X(parseInt(t,10),1,parseInt(e.max,10)),s=e.noReset!==!0&&e.modelValue===a?0:a;s!==e.modelValue&&v("update:modelValue",s),i.value=0}}function w(t){u.value===!0&&(i.value=t)}function l(t,a){switch(t.keyCode){case 13:case 32:return S(a),R(t);case 37:case 40:return r[`rt${a-1}`]&&r[`rt${a-1}`].focus(),R(t);case 39:case 38:return r[`rt${a+1}`]&&r[`rt${a+1}`].focus(),R(t)}}function o(){i.value=0}return K(()=>{r={}}),()=>{const t=[];return q.value.forEach(({iconClass:a,name:s,attrs:g},b)=>{const n=b+1;t.push(Q("div",{key:n,ref:m=>{r[`rt${n}`]=m},class:"q-rating__icon-container flex flex-center",...g,onClick(){S(n)},onMouseover(){w(n)},onMouseout:o,onFocus(){w(n)},onBlur:o,onKeyup(m){l(m,n)}},O(x[`tip-${n}`],[Q(G,{class:a,name:s})])))}),e.name!==void 0&&e.disable!==!0&&L(t,"push"),Q("div",{class:$.value,style:I.value,...B.value},t)}}});const ge={class:"col-auto"},be={class:"col-auto q-gutter-md"},Ce={__name:"connectionRate",props:{item:Object},emits:["feedbackclosed"],setup(e,{emit:x}){const v=e;let C=Z("can");const I=p(()=>ee(()=>import("./deleteConnectionotes.25163b3d.js"),["assets/deleteConnectionotes.25163b3d.js","assets/app.947dfe37.js","assets/app.51e76855.css"]));let h=te(),L=y({sortBy:"time",descending:!0,page:1,rowsPerPage:0});ae(async()=>{window.Echo.private("connectionnotes."+v.item.connection.id).listen("ConnectionNotesUpdate",l=>{l.flag.flag==1&&h.getConnectionNotes(v.item.connection.id)}),await h.getConnectionNotes(v.item.connection.id).then($.value=!1)}),ne(async()=>{window.Echo.leave("connectionnotes."+v.item.connection.id)});let i=y(!1),r=y(null),u=y(0),$=y(!0),k=()=>{i.value=!0},H=()=>{r.value=null,u.value=0,i.value=!1,x("feedbackclosed")},q=async()=>{let l={connection_id:v.item.connection.id,text:r.value,rating:u.value};await axios({method:"post",withCredentials:!0,url:"/api/addconnectionnote",data:l,headers:{Accept:"application/json","Content-Type":"application/json"}}),r.value=null,u.value=0,x("feedbackclosed")},B=f(()=>h.connectionNotes),S=f(()=>!(r.value!=null||u.value!=0)),w=y([{name:"test",required:!0,label:"Text",align:"left",field:l=>l.text,format:l=>`${l}`},{name:"user",required:!0,label:"User",align:"left",field:l=>l.user_madeby.name,format:l=>`${l}`,sortable:!1},{name:"time",required:!0,label:"Time",align:"left",field:l=>l.created_at,format:l=>fe.formatDate(l,"YYYY-MM-DD - HH:mm"),sortable:!0},{name:"rating",required:!0,label:"Rating",align:"left",field:l=>l.rating,format:l=>`${l}`},{name:"actions",label:"",align:"right"}]);return(l,o)=>(D(),le("div",null,[c(N,{flat:"",icon:"fa-solid fa-comment-alt",label:"Connection Feedback",onClick:o[0]||(o[0]=t=>_(k)())}),c(ue,{modelValue:i.value,"onUpdate:modelValue":o[5]||(o[5]=t=>i.value=t),persistent:""},{default:d(()=>[c(oe,{class:"myRoundTop",style:{width:"1200px","max-width":"1200px"}},{default:d(()=>[c(V,{class:"bg-primary text-h4 text-center"},{default:d(()=>[ie(" Rate this Connection ")]),_:1}),c(V,null,{default:d(()=>[_(C)("view_connection_notes")?(D(),re(de,{key:0,title:"Connections",class:"myConnectionFeedBackTable myRound",rows:B.value,flat:"","hide-bottom":"",columns:w.value,"table-class":" text-webway","table-header-class":" text-weight-bolder bg-amber","row-key":"id",ref:"tableRef",dark:"",rounded:"",color:"webwayback",pagination:L.value},{top:d(t=>[]),"body-cell-actions":d(t=>[c(se,{props:t},{default:d(()=>[c(_(I),{item:t.row},null,8,["item"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])):ce("",!0)]),_:1}),c(V,null,{default:d(()=>[c(me,{"input-style":"width: 1200px",modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=t=>r.value=t),placeholder:"Enter notes here",outlined:"",type:"textarea"},null,8,["modelValue"])]),_:1}),c(V,{class:"row items-center justify-between"},{default:d(()=>[j("div",ge,[c(ve,{modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=t=>u.value=t),size:"xl",icon:"star"},null,8,["modelValue"])]),j("div",be,[c(N,{color:"primary",rounded:"",label:"Submit",onClick:o[3]||(o[3]=t=>_(q)()),disabled:S.value},null,8,["disabled"]),c(N,{color:"secondary",label:"Close",rounded:"",onClick:o[4]||(o[4]=t=>_(H)())})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ce as default};
