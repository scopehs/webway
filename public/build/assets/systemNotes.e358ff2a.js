import{I as D,J as B,u as A,d as E,_ as H,r as u,c as d,e as f,f as I,g as l,n as m,E as p,w as s,Q as M,j as c,k as P,z as $,q as g,s as _,aF as j,h as v,aH as R}from"./app.947dfe37.js";import{Q as Y}from"./QTd.5e156fed.js";import{Q as q}from"./QTable.8d314c3a.js";import{Q as F}from"./QInput.0a5b359e.js";import{C as x}from"./ClosePopup.32ce8d79.js";import{d as U}from"./date.e8c4c223.js";const z={__name:"systemNotes",props:{system:Object,type:Number},setup(y){const n=y;B(e=>({62508494:T.value}));let r=A();const b=E(()=>H(()=>import("./deleteSystemNotes.285af2f9.js"),["assets/deleteSystemNotes.285af2f9.js","assets/app.947dfe37.js","assets/app.51e76855.css"]));let w=u({sortBy:"time",descending:!0,page:1,rowsPerPage:50}),i=u(!1),o=u(null),C=()=>{i.value=!0},h=()=>{o.value=null,i.value=!1},N=async()=>{let e={system_id:n.system.system_id,text:o.value};await axios({method:"post",withCredentials:!0,url:"/api/addsystemnotes",data:e,headers:{Accept:"application/json","Content-Type":"application/json"}}),o.value=null},k=d(()=>n.type==1?r.currentSystemNotes:r.lastSystemNotes),Q=d(()=>n.type==1?r.currentSystemNotes.length==0?"fa-regular fa-message":"fa-solid fa-message":r.lastSystemNotes.length==0?"fa-regular fa-message":"fa-solid fa-message"),V=d(()=>o.value==null),S=u([{name:"text",label:"Text",align:"left",field:e=>e.text,format:e=>`${e}`},{name:"user",label:"User",align:"left",field:e=>e.user.name,format:e=>`${e}`,sortable:!0},{name:"time",label:"Time",align:"left",field:e=>e.created_at,format:e=>U.formatDate(e,"YYYY-MM-DD - HH:mm"),sortable:!0},{name:"actions",label:"",align:"right"}]),T=d(()=>{let e=50;return r.size.height-e+"px"});return(e,t)=>(f(),I("div",null,[l(p,{"text-color":"primary",icon:Q.value,round:"",padding:"none",onClick:t[0]||(t[0]=a=>m(C)())},null,8,["icon"]),l(R,{modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=a=>i.value=a),persistent:"",onBeforeHide:t[4]||(t[4]=a=>m(h)())},{default:s(()=>[l(M,{style:{"max-width":"1200px","max-height":"1200px"},class:"myRoundTop"},{default:s(()=>[l(c,{class:"myCardHeader bg-primary text-h5 text-center"},{default:s(()=>[P(" Notes for "+$(y.system.name),1)]),_:1}),l(c,null,{default:s(()=>[l(q,{class:"myRound bg-webBack myStepMessageTable",rows:k.value,columns:S.value,style:{width:"1000px"},"table-class":"text-webway","table-header-class":"bg-amber","row-key":"id",dense:"",dark:"",ref:"tableRef",rounded:"",color:"amber",pagination:w.value},{"top-right":s(a=>[l(p,{flat:"",padding:"none",round:"",dense:"",icon:a.inFullscreen?"fullscreen_exit":"fullscreen",onClick:a.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),"body-cell-actions":s(a=>[l(Y,{props:a},{default:s(()=>[l(m(b),{item:a.row},null,8,["item"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])]),_:1}),n.type==1?(f(),g(c,{key:0},{default:s(()=>[l(F,{"input-style":"height: 100px min-width:700px",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=a=>o.value=a),autofocus:"",placeholder:"Enter notes here",outlined:"",type:"textarea"},null,8,["modelValue"])]),_:1})):_("",!0),l(j,{align:"right"},{default:s(()=>[n.type==1?v((f(),g(p,{key:0,color:"positive",label:"Submit",onClick:t[2]||(t[2]=a=>m(N)()),disabled:V.value,rounded:""},null,8,["disabled"])),[[x]]):_("",!0),v(l(p,{color:"secondary",rounded:"",label:"Close"},null,512),[[x]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},X=D(z,[["__scopeId","data-v-633ce103"]]);export{X as default};
